<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

  <head>
    <title>Ground Locations</title>
    <style>
      body {text-align:center;font-family:Verdana;}
      .frame {background-color:grey; width:90%; margin:auto;font-size:85%;border-style: solid;border-width:5px;border-color:grey}
      .frame .sect {wdith:50%; float:left;margin:0px 0px 0px 0px}
      .subsect {width:100%; margin:auto}
      .map {height:300px; margin:2px 0px 2px 0px}
	    .sect {color:white; font-size:90%}
	    
      #bottom {clear:both}
      td, th {padding:1% 1% 1% 1%}
      tr {margin:1% 0% 1% 0%}
    </style>
  <script src="https://ravikirankella.github.io/Cricket/loc_scripts.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  
  <script>
    $(document).ready(function(){
        $(".subsect").width(($("#frm").width())/2);
        $(".sect").width(($("#frm").width())/2);
	
	var tbl= document.getElementById("tbl");
      	var loc = loc_list("all");
	      	for (i = 0; i <loc.length; i++) {
        	var rowrec = loc[i];
        	var row = tbl.insertRow(-1);
		var row_len = rowrec.length;
          	for (j=0; j <row_len-1; j++) {
          		if (j==row_len-2){
			var cell = row.insertCell(-1);
          		cell.innerHTML = rowrec[j]+', '+rowrec[j+1];
			}
			else if (j==0){
				var cell = row.insertCell(-1);
          			cell.innerHTML = rowrec[j];
				cell.className="clck";
			}
			else {
				var cell = row.insertCell(-1);
          			cell.innerHTML = rowrec[j];
				}
          	}
	}
	$(".clck").css({"color":"blue","font-weight": "bold","background-color":"white"});
   
 
    });

  </script>
  
  </head>
  
  <body>
  
    <h1>Ground Locations</h1>
    <div class="frame" id="frm">
      <div class="sect" id="tbl_loc">
        <table id="tbl">
          <tr><th>Ground</th><th>Nearest PostCode</th><th>Geo Code</th></tr>
        <!--  <tr><td>Queens</td><td>OX1 4PP</td><td>51.743363, -1.252402</td></tr>
          <tr><td>SSJ</td><td>OX33 1ET</td><td>51.774466, -1.162412</td></tr>
          <tr><td>Eynsham</td><td>OX29 4LF</td><td>51.785588, -1.360644</td></tr>
          <tr><td>Peppard Stoke Row</td><td>RG9 5JD</td><td>51.528351, -0.988155</td></tr>
          <tr><td>Appleton</td><td>OX13 5QW</td><td>51.6983675, -1.3756933</td></tr>
          <tr><td>Bartlemas</td><td>OX4 2AE</td><td>51.745539, -1.225515</td></tr>
          <tr><td>Enstone</td><td>OX7 4AZ</td><td>51.911547, -1.451832</td></tr>
          <tr><td>Ipsden</td><td>OX10 6AL</td><td>51.560684, -1.087598</td></tr>
          <tr><td>Islip</td><td>OX5 2SP</td><td>51.823254, -1.239241</td></tr>
          <tr><td>Kempsford</td><td>GL7 4EQ</td><td>51.669613, -1.772568</td></tr>
          <tr><td>Middleton Stoney</td><td>?</td><td>?</td></tr>
          <tr><td>Minster Lovell</td><td>OX29 0RN</td><td>51.798214, -1.538759</td></tr>
          <tr><td>OUP (Jordan Hill)</td><td>OX2 8EU</td><td>51.793405, -1.275522</td></tr>
          <tr><td>Peppard Stoke Row</td><td>RG9 5JD</td><td>51.528351, -0.988155</td></tr>
          <tr><td>Swindon Nomads</td><td>?</td><td>?</td></tr>
          <tr><td>Temple Cloud</td><td>?</td><td>?</td></tr>
          <tr><td>Wiley-Blackwells (Horsepath)</td><td>OX33 1RT</td><td>51.737729, -1.175608</td></tr>
          <tr><td>Wolvercote (Cutteslowe Park)</td><td>OX2 8NP</td><td>51.792418, -1.265106</td></tr>
          <tr><td>Wytham</td><td>OX2 8QA</td><td>51.775372, -1.312852</td></tr> -->
        </table>
      </div>
      
      <div class="sect">
        <div class="subsect"><h3>View on Map</h3></div>
        <div class="subsect map" id="map1" ></div>
        <div class="subsect map" id="map2" ></div>
      </div>
      <button onclick="Mapupdate()">Update</button>
      <div id="bottom"><div>
    </div>
    
     <script>
      function initMap() {
	var mapCanvas1 = document.getElementById("map1");
	var mapOptions1 = {
    	center: new google.maps.LatLng(51.743363, -1.252402),
    	zoom:9,
    	mapTypeId:google.maps.MapTypeId.ROADMAP
  	};
	var map1 = new google.maps.Map(mapCanvas1,mapOptions1);
	var marker;
        var loc = loc_list("valid");
	for (i = 0; i <loc.length; i++) {
    		if (loc[i][1]!=''){
    		marker = new google.maps.Marker({position: new google.maps.LatLng(loc[i][2], loc[i][3]),label:loc[i][0],map: map1});
    		}
	}
      }
      
     function Mapupdate(lat="",long="") {
	     if(lat=="")
	     {
        lat ="51.743363";
        long= "-1.252402";
	     }
        var map = new google.maps.Map(document.getElementById("map1"), {
          zoom: 15,
          //center: uluru
          center: new google.maps.LatLng(lat,long)
        });
        var marker = new google.maps.Marker({
          position: new google.maps.LatLng(lat,long),
          map: map
        });
      }

	function MapDirections(lat="",long="") {
		if(lat==""){
        	lat ="51.743363";
        	long= "-1.252402";
	     }
        var directionsService = new google.maps.DirectionsService;
        var directionsDisplay = new google.maps.DirectionsRenderer;
        var map = new google.maps.Map(document.getElementById('map2'), {
          zoom: 7,
          center: new google.maps.LatLng(lat,long)
        });
        directionsDisplay.setMap(map);
        directionsService.route({
          origin: new google.maps.LatLng("51.743363","-1.252402");
          destination: new google.maps.LatLng(lat,long);
          travelMode: 'DRIVING'
        }, function(response, status) {
          if (status === 'OK') {
            directionsDisplay.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });

      }
  
	
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAaBGIiQEFd4xGMwKVmr7EYrA5hxbEEjH0&callback=initMap"></script>
  
	<script>
		 $(document).ready(function(){
		    $("#frm").resize(function(){
        $(".subsect").width(($("#frm").width())/2);
        $(".sect").width(($("#frm").width())/2);
    });
    
    $(".clck").click(function(){
	var cur=$(this);
	$(".clck").css({"color":"blue","font-weight": "bold","background-color":"white"});
	cur.css({"color":"white","font-weight": "bold","background-color":"blue"});
	var location = loc_list(cur.text());
	Mapupdate(location[2],location[3]);
	MapDirections(location[2],location[3]);
    });
			 });
	      </script>
    
  </body>
 
 </html> 
